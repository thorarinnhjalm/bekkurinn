# Bekkurinn - Project Documentation

> The essential organization tool for Icelandic Class Representatives (Bekkjafulltrúar) and parents.

Bekkurinn is a secure, GDPR-compliant platform specifically designed to streamline elementary school class management in Iceland. It replaces chaotic social media threads with structured, private tools for scheduling and communication.

## Core Value Proposition
- **Privacy & Security**: Secure, verified environment vs. open Facebook groups.
- **Automation**: Automated management of "Rölt" (Neighborhood Patrol) and events.
- **Inclusion**: Built-in multi-lingual support (Icelandic, English, Polish).

## Tech Stack & Architecture

### Frontend
- **Framework**: Next.js 16+ (App Router)
- **Language**: TypeScript (Strict Mode)
- **Styling**: Tailwind CSS v4, Lucide React Icons
- **State/Caching**: React Query (TanStack Query) v5
- **Local State**: Zustand
- **I18n**: next-intl

### Backend & Data
- **Platform**: Firebase (Client SDK)
- **Database**: Cloud Firestore
- **Auth**: Firebase Authentication (Google Provider)
- **Email**: Resend API

## Data Schema (Firestore)

The application relies on a strictly typed Firestore schema. Review `src/types/index.ts` for exact definitions.

### Key Collections:
1.  **`users`**: User profiles linked to Firebase Auth.
    *   Fields: `uid`, `email`, `phone`, `language` ('is'|'en'|'pl').
2.  **`classes`**: The central entity grouping students and parents.
    *   Fields: `joinCode`, `schoolName`, `grade`, `admins` (array of UIDs).
3.  **`students`**: Children profiles belonging to a class.
    *   Fields: `classId`, `name`, `dietaryNeeds`, `photoPermission`.
4.  **`parentLinks`**: Junction table linking Users to Students.
    *   Fields: `status` ('pending'|'approved').
5.  **`tasks`**: Polymorphic collection for calendar items.
    *   Types: `rolt` (patrol), `event`.
    *   Logic: Handles volunteer slots via `volunteers` array.
6.  **`announcements`**: pinned/unpinned posts from admins.

## Project Structure

- **`src/app`**: Next.js App Router.
- **`src/services/firestore.ts`**: **CRITICAL**. The abstraction layer for all database interactions. Always use functions from here (e.g., `getStudentsByClass`) rather than raw Firestore calls in components.
- **`src/types/index.ts`**: Shared TypeScript interfaces.
- **`src/components`**: UI components.

## For AI Agents

When modifying this project, adhere to the following:
1.  **Data Access**: Always check `src/services/firestore.ts` first. If a method exists, use it. If not, add it there, then use it in the UI.
2.  **Type Safety**: Never use `any`. Import types from `@/types`.
3.  **Aesthetics**: The design system is "Nordic Simple" with a sage green primary theme. Use Tailwind classes.
4.  **Context**: The app is "Bekkurinn".
    *   "Rölt" = Neighborhood Patrol (parents walking around school neighborhood).
    *   "Bekkjafulltrúi" = Class Representative (Admin).
